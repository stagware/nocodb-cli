# Project Structure

## Monorepo Layout

This is an npm workspace monorepo with two packages:

```
nocodb-cli/
├── packages/
│   ├── sdk/          # TypeScript SDK for NocoDB API
│   └── cli/          # Command-line interface
├── scripts/          # E2E and utility scripts
└── .kiro/            # Kiro configuration and steering
```

## Package: SDK (`packages/sdk`)

The SDK provides the core HTTP client and API abstractions.

```
packages/sdk/
├── src/
│   └── index.ts      # NocoClient class, interfaces, retry logic
├── test/             # Unit tests (*.test.ts)
├── dist/             # Build output (generated)
└── package.json
```

**Key exports**:
- `NocoClient`: Main client class with retry and timeout support
- `ClientOptions`, `RequestOptions`, `RetryOptions`: Configuration interfaces

## Package: CLI (`packages/cli`)

The CLI wraps the SDK and provides command-line access.

```
packages/cli/
├── src/
│   ├── index.ts              # CLI entry point, program setup
│   ├── config.ts             # Legacy config management
│   ├── settings.ts           # Timeout/retry settings
│   ├── aliases.ts            # Alias resolution (workspace-namespaced)
│   ├── lib.ts                # Shared utilities
│   └── commands/
│       ├── api.ts            # Dynamic API command registration
│       ├── helpers.ts        # Command builder utilities
│       ├── links.ts          # Link operations
│       ├── meta.ts           # Meta operations (swagger, cache)
│       ├── request.ts        # Raw HTTP requests
│       ├── rows.ts           # Row CRUD and bulk operations
│       ├── storage.ts        # File upload
│       ├── workspace-alias.ts # Workspace and alias management
│       └── meta-crud/        # CRUD commands for meta entities
│           ├── bases.ts
│           ├── tables.ts
│           ├── views.ts
│           ├── columns.ts
│           ├── filters.ts
│           ├── sorts.ts
│           └── types.ts      # Shared types for meta commands
├── test/                     # Unit tests (*.test.ts)
├── dist/                     # Build output (generated)
└── package.json
```

## Command Organization

Commands are organized by domain:
- **Meta CRUD**: `commands/meta-crud/*.ts` - bases, tables, views, columns, filters, sorts
- **Data operations**: `commands/rows.ts` - row CRUD and bulk operations
- **Dynamic API**: `commands/api.ts` - swagger-driven endpoint discovery
- **Configuration**: `config.ts`, `settings.ts`, `aliases.ts`
- **Utilities**: `commands/storage.ts`, `commands/request.ts`, `commands/links.ts`

## Configuration Files

- **User config**: `~/.nocodb-cli/` (or `$NOCODB_SETTINGS_DIR`)
  - `config.json`: Legacy global config (baseUrl, baseId, headers)
  - `settings.json`: Timeout and retry settings
  - Workspace aliases stored per workspace
- **Swagger cache**: Stored in config directory for faster reuse

## Test Organization

- Tests mirror source structure: `test/*.test.ts` corresponds to `src/*.ts`
- Both packages use vitest
- E2E script: `scripts/e2e-cli.mjs` (comprehensive integration test)

## Build Artifacts

- `dist/` directories are generated by tsup (gitignored)
- SDK produces ESM + type declarations
- CLI produces executable with shebang for `nocodb` command
